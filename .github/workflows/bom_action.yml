name: BOM Automation Logic

on:
  workflow_dispatch: # 這裡就是控制「紅色框框」選單的地方
    inputs:
      mode_selection: # 變數名稱
        description: '請選擇執行模式 (Select Mode)' # 這裡的文字會顯示在選單上方
        required: true
        default: '3. 完整模式 (Full Mode)'
        type: choice
        options: # 這裡設定下拉選單的選項，我加上了中文說明防止選錯
          - '1. 僅詢價 (Price Check Only)'
          - '2. 僅歸檔 (Filing Only)'
          - '3. 完整模式 (Full Mode)'

jobs:
  run-bom-script:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Install dependencies
        run: |
          pip install -r requirements.txt

      - name: Run BOM Manager
        env:
          GOOGLE_SHEETS_JSON: ${{ secrets.GOOGLE_SHEETS_JSON }}
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          # 這裡將您在 UI 選單選的值 (例如 "1. 僅詢價...") 傳給 Python
          EXECUTION_MODE: ${{ github.event.inputs.mode_selection }} 
        run: python bom_manager.py
