name: CosIng Ingredient Search

# 設定觸發條件
on:
  schedule:
    # 每天台灣時間上午 10:00 執行 (UTC 02:00)
    - cron: '0 2 * * *'
  workflow_dispatch: # 允許手動從 Actions 頁面按鈕觸發

jobs:
  run-search:
    runs-on: ubuntu-latest
    
    steps:
      # 1. 檢出倉庫代碼
      - name: Checkout repository
        uses: actions/checkout@v3

      # 2. 設定 Python 環境
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      # 3. 安裝必要套件 (包含 Selenium、gspread 與認證工具)
      - name: Install dependencies
        run: |
          pip install gspread oauth2client selenium webdriver-manager

      # 4. 執行爬蟲與資料同步腳本
      - name: Execute CosIng automation
        env:
          # 從 GitHub Secrets 讀取 Google 試算表金鑰
          GOOGLE_SHEETS_JSON: ${{ secrets.GOOGLE_SHEETS_JSON }}
        run: python cosing_automation.py
